<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Be My Valentine?</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(255, 238, 248, 0.5);
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #e85a8f, #d64570);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #d64570;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background: url('images/DSC_7349.JPG') center/cover fixed no-repeat;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 238, 248, 0.85) 0%, rgba(255, 224, 240, 0.9) 50%, rgba(255, 208, 232, 0.85) 100%);
            z-index: -1;
            animation: gradientShift 8s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { 
                background: linear-gradient(135deg, rgba(255, 238, 248, 0.85) 0%, rgba(255, 224, 240, 0.9) 50%, rgba(255, 208, 232, 0.85) 100%);
            }
            50% { 
                background: linear-gradient(135deg, rgba(255, 224, 240, 0.9) 0%, rgba(255, 208, 232, 0.85) 50%, rgba(255, 238, 248, 0.85) 100%);
            }
        }

        /* DARK MODE - COMPLETELY FIXED */
        body.dark-mode {
            background: url('https://images.unsplash.com/photo-1518621736915-f3b1c41bfd00?w=1920') center/cover fixed no-repeat;
        }

        body.dark-mode::before {
            background: linear-gradient(135deg, rgba(26, 10, 26, 0.95) 0%, rgba(45, 27, 45, 0.98) 50%, rgba(31, 15, 31, 0.95) 100%) !important;
            animation: none;
        }

        body.dark-mode .card-frame {
            background: rgba(30, 15, 30, 0.4);
            border-color: rgba(232, 90, 143, 0.3);
            box-shadow: 0 8px 32px rgba(232, 90, 143, 0.15);
        }

        body.dark-mode h1, 
        body.dark-mode h2 {
            color: #ff69b4;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
        }

        body.dark-mode .date-badge,
        body.dark-mode .garden-badge,
        body.dark-mode .milestone-bubble,
        body.dark-mode .music-play-btn {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        }

        body.dark-mode .love-quotes-container .love-quote {
            background: rgba(30, 15, 30, 0.85);
            color: #ff69b4;
            border-color: rgba(232, 90, 143, 0.5);
        }

        body.dark-mode .milestone-bubble {
            background: rgba(30, 15, 30, 0.85);
            color: #ff69b4;
            border-color: rgba(232, 90, 143, 0.5);
        }

        body.dark-mode .milestone-bubble:hover {
            background: rgba(232, 90, 143, 0.9);
            color: white;
        }

        body.dark-mode .nav-arrow {
            background: rgba(30, 15, 30, 0.9);
            color: #ff69b4;
            border-color: rgba(232, 90, 143, 0.5);
        }

        body.dark-mode .nav-arrow:hover {
            background: #ff69b4;
            color: white;
        }

        body.dark-mode .nav-dots .dot {
            background: rgba(255, 105, 180, 0.3);
        }

        body.dark-mode .nav-dots .dot.active {
            background: #ff69b4;
        }

        body.dark-mode .typewriter-text,
        body.dark-mode .reason-text {
            color: #e0e0e0;
        }

        body.dark-mode .calculator-box,
        body.dark-mode .quiz-box {
            background: rgba(30, 15, 30, 0.8);
        }

        body.dark-mode .calc-input,
        body.dark-mode .quiz-option {
            background: rgba(20, 10, 20, 0.9);
            color: white;
            border-color: #ff69b4;
        }

        body.dark-mode ::-webkit-scrollbar-track {
            background: rgba(30, 15, 30, 0.8);
        }

        body.dark-mode .lightbox {
            background: rgba(0, 0, 0, 0.95);
        }

        body.dark-mode .garden-container {
            background: #1a0f1a;
        }

        body.dark-mode .rose-message {
            background: linear-gradient(135deg, #2a152a, #1f0f1f);
            color: #ff69b4;
        }

        body.dark-mode .love-timeline {
            background: rgba(30, 15, 30, 0.9);
            border-color: rgba(232, 90, 143, 0.5);
        }

        body.dark-mode .timeline-label {
            color: #ff69b4;
        }

        body.dark-mode .timeline-date {
            color: #aaa;
        }

        body.dark-mode .timeline-line::after {
            background: #1a0f1a;
        }

        h1, h2, .romantic-text {
            font-family: 'Great Vibes', cursive;
        }

        /* Parallax Background Hearts */
        .parallax-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .parallax-heart {
            position: absolute;
            font-size: 20px;
            opacity: 0.3;
            animation: floatUp linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.3; }
            90% { opacity: 0.3; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }

        /* Love Quotes - Fixed */
        .love-quotes-container {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 220px;
            z-index: 50;
            pointer-events: none;
        }

        .love-quote {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 15px;
            border-left: 4px solid #e85a8f;
            font-family: 'Great Vibes', cursive;
            color: #d64570;
            font-size: 1.1rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            pointer-events: auto;
        }

        .love-quote.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Milestone Bubbles */
        .milestone-container {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 20px;
            z-index: 50;
        }

        .milestone-bubble {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            padding: 12px 18px;
            border-radius: 25px;
            border: 2px solid rgba(232, 90, 143, 0.4);
            font-size: 0.85rem;
            color: #d64570;
            font-weight: 600;
            transform: translateX(-100px);
            opacity: 0;
            animation: slideInMilestone 0.5s forwards;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(232, 90, 143, 0.2);
        }

        .milestone-bubble:hover {
            transform: translateX(0) scale(1.1);
            background: rgba(232, 90, 143, 0.9);
            color: white;
        }

        .milestone-bubble:nth-child(1) { animation-delay: 0.5s; }
        .milestone-bubble:nth-child(2) { animation-delay: 0.7s; }
        .milestone-bubble:nth-child(3) { animation-delay: 0.9s; }
        .milestone-bubble:nth-child(4) { animation-delay: 1.1s; }

        @keyframes slideInMilestone {
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #e85a8f, #d64570);
            z-index: 10000;
            transition: width 0.3s;
        }

        .start-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 238, 248, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s;
        }

        .start-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .start-heart {
            font-size: 100px;
            animation: heartbeat 1.5s infinite;
            margin-bottom: 30px;
            filter: drop-shadow(0 10px 30px rgba(232, 90, 143, 0.4));
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.1); }
        }

        .start-text {
            color: #d64570;
            font-size: 3rem;
            text-align: center;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .start-subtext {
            color: #e85a8f;
            font-size: 1.2rem;
            margin-bottom: 30px;
            font-family: 'Quicksand', sans-serif;
        }

        .start-btn {
            background: linear-gradient(135deg, #e85a8f, #d64570);
            color: white;
            border: none;
            padding: 22px 60px;
            border-radius: 50px;
            font-size: 1.4rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(232, 90, 143, 0.4);
            transition: all 0.3s;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
        }

        .start-btn:hover {
            transform: scale(1.05);
        }

        .cursor-trail {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            font-size: 20px;
            animation: trailFade 1s ease-out forwards;
        }

        @keyframes trailFade {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0) translateY(-40px); }
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            perspective: 1000px;
        }

        /* 3D Card with Glass Morphism */
        .card-frame {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 40px 30px;
            margin: 60px 20px 100px 20px;
            box-shadow: 
                0 8px 32px rgba(232, 90, 143, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.6),
                0 0 0 1px rgba(255, 255, 255, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.4);
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow: visible;
            min-height: 550px;
            transform-style: preserve-3d;
            transition: transform 0.3s ease;
        }

        /* Spotlight Effect */
        .card-frame::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(
                circle at var(--mouse-x, 50%) var(--mouse-y, 50%),
                rgba(255, 255, 255, 0.3) 0%,
                transparent 50%
            );
            border-radius: 30px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card-frame:hover::before {
            opacity: 1;
        }

        .page {
            width: 100%;
            display: none;
            flex-direction: column;
            align-items: center;
            position: absolute;
            opacity: 0;
            transform: translateX(50px) scale(0.95);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .page.active {
            display: flex;
            opacity: 1;
            transform: translateX(0) scale(1);
            position: relative;
        }

        .page.exit-left {
            transform: translateX(-50px) scale(0.95);
            opacity: 0;
        }

        .page.exit-right {
            transform: translateX(50px) scale(0.95);
            opacity: 0;
        }

        /* Nav Arrows Attached to Card */
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(232, 90, 143, 0.4);
            color: #e85a8f;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(232, 90, 143, 0.3);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
        }

        .nav-arrow.visible {
            opacity: 0.8;
            pointer-events: all;
        }

        .nav-arrow:hover {
            background: #e85a8f;
            color: white;
            transform: translateY(-50%) scale(1.15);
            box-shadow: 0 6px 25px rgba(232, 90, 143, 0.5);
        }

        .nav-arrow.prev { 
            left: -60px;
        }

        .nav-arrow.next { 
            right: -60px;
        }

        @media (max-width: 600px) {
            .nav-arrow.prev { left: -40px; }
            .nav-arrow.next { right: -40px; }
            .nav-arrow { width: 40px; height: 40px; }
        }

        .date-badge {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #e85a8f, #d64570);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 5px 20px rgba(232, 90, 143, 0.4);
            z-index: 300;
            font-family: 'Quicksand', sans-serif;
        }

        .date-badge .label {
            font-size: 0.7rem;
            opacity: 0.9;
            display: block;
            margin-bottom: 3px;
        }

        .date-badge .value {
            font-size: 1rem;
            font-weight: bold;
        }

        .garden-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #e85a8f;
            border-radius: 50px;
            padding: 10px 20px;
            z-index: 1000;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(232, 90, 143, 0.3);
            font-family: 'Quicksand', sans-serif;
        }

        .garden-badge:hover {
            transform: scale(1.1);
            background: #e85a8f;
            color: white;
        }

        .garden-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .garden-modal.active {
            display: flex;
        }

        .garden-container {
            background: white;
            border-radius: 30px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
            text-align: center;
        }

        .rose-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .rose-item {
            font-size: 3.5rem;
            cursor: pointer;
            transition: all 0.4s;
            opacity: 0.3;
            filter: grayscale(100%) blur(2px);
        }

        .rose-item.unlocked {
            opacity: 1;
            filter: grayscale(0%) blur(0);
            animation: bloom 0.8s ease;
        }

        .rose-item.unlocked:hover {
            transform: scale(1.3) rotate(10deg);
        }

        @keyframes bloom {
            0% { transform: scale(0) rotate(-180deg); }
            50% { transform: scale(1.3) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .rose-message {
            display: none;
            background: linear-gradient(135deg, #ffe0f0, #ffd0e8);
            padding: 20px;
            border-radius: 15px;
            margin-top: 15px;
            color: #d64570;
            font-family: 'Great Vibes', cursive;
            font-size: 1.5rem;
        }

        .rose-message.show {
            display: block;
        }

        .completion-toast {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: linear-gradient(135deg, #e85a8f, #d64570);
            color: white;
            padding: 18px 35px;
            border-radius: 50px;
            box-shadow: 0 8px 25px rgba(232, 90, 143, 0.5);
            z-index: 3000;
            opacity: 0;
            transition: all 0.5s;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .completion-toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .audio-permission {
            display: none;
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #e85a8f, #d64570);
            color: white;
            padding: 18px 35px;
            border-radius: 50px;
            z-index: 5000;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            animation: bounce 2s infinite;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
        }

        .audio-permission.show {
            display: block;
        }

        .music-play-btn {
            position: fixed;
            top: 90px;
            right: 20px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: linear-gradient(135deg, #e85a8f, #d64570);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(232, 90, 143, 0.4);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }

        .music-play-btn:hover {
            transform: scale(1.15) rotate(15deg);
        }

        .music-play-btn.playing {
            animation: musicPulse 2s infinite;
        }

        @keyframes musicPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(232, 90, 143, 0.7); }
            50% { box-shadow: 0 0 0 20px rgba(232, 90, 143, 0); }
        }

        .dark-mode-toggle {
            position: fixed;
            bottom: 90px;
            left: 20px;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid #e85a8f;
            color: #e85a8f;
            font-size: 1.6rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            transition: all 0.3s;
        }

        .dark-mode-toggle:hover {
            transform: scale(1.1) rotate(180deg);
            background: #e85a8f;
            color: white;
        }

        .gift-icon {
            font-size: 70px;
            margin-bottom: 20px;
            margin-top: 10px;
            animation: bounce 2s infinite;
            filter: drop-shadow(0 5px 15px rgba(232, 90, 143, 0.4));
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        h1 {
            color: #d64570;
            font-size: 3.5rem;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 3px 3px 6px rgba(255, 255, 255, 0.6);
            line-height: 1.2;
        }

        h2 {
            color: #d64570;
            font-size: 2.8rem;
            text-align: center;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.5);
        }

        .love-meter {
            width: 85%;
            max-width: 320px;
            margin: 20px 0;
            display: none;
        }

        .love-meter.visible {
            display: block;
            animation: slideUp 0.5s ease;
        }

        .meter-label {
            text-align: center;
            color: #d64570;
            font-size: 1.5rem;
            margin-bottom: 12px;
            font-weight: 600;
            font-family: 'Great Vibes', cursive;
        }

        .meter-bar {
            height: 25px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.1);
        }

        .meter-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ffb6c1, #ff69b4, #e85a8f, #d64570);
            border-radius: 15px;
            transition: width 2s ease;
            position: relative;
        }

        .meter-fill.full { width: 100%; }

        .meter-percentage {
            text-align: center;
            color: #e85a8f;
            font-size: 2rem;
            font-weight: bold;
            margin-top: 12px;
            font-family: 'Great Vibes', cursive;
        }

        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            max-width: 280px;
            height: 250px;
            position: relative;
            margin-top: 20px;
        }

        .no-btn {
            background: white;
            color: #e85a8f;
            border: 3px solid #e85a8f;
            padding: 18px 45px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            position: absolute;
            left: 50%;
            top: 0;
            transform: translateX(-50%);
            white-space: nowrap;
            z-index: 10;
            user-select: none;
            font-family: 'Quicksand', sans-serif;
        }

        .yes-btn {
            background: linear-gradient(135deg, #e85a8f 0%, #d64570 100%);
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(232, 90, 143, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: absolute;
            left: 50%;
            bottom: 20px;
            transform: translateX(-50%);
            white-space: nowrap;
            font-family: 'Quicksand', sans-serif;
        }

        .yes-btn:hover {
            transform: translateX(-50%) translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(232, 90, 143, 0.6);
        }

        .reasons-container {
            width: 100%;
            max-width: 380px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
        }

        .reason-box {
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 15px rgba(232, 90, 143, 0.15);
            cursor: pointer;
            transition: all 0.3s;
            animation: slideIn 0.5s ease forwards;
            opacity: 0;
            transform: translateX(-20px);
            border-left: 4px solid #e85a8f;
        }

        .reason-box:nth-child(1) { animation-delay: 0.1s; }
        .reason-box:nth-child(2) { animation-delay: 0.2s; }
        .reason-box:nth-child(3) { animation-delay: 0.3s; }
        .reason-box:nth-child(4) { animation-delay: 0.4s; }
        .reason-box:nth-child(5) { animation-delay: 0.5s; }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .reason-box:hover {
            transform: translateX(10px);
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 6px 20px rgba(232, 90, 143, 0.25);
        }

        .reason-icon {
            font-size: 2rem;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .reason-text {
            font-size: 1.15rem;
            color: #555;
            font-family: 'Quicksand', sans-serif;
        }

        .typewriter-text {
            overflow: hidden;
            white-space: pre-line;
            display: block;
            min-height: 200px;
            color: #444;
            line-height: 1.9;
            font-size: 1.15rem;
            font-family: 'Quicksand', sans-serif;
        }

        .game-wrapper {
            width: 100%;
            max-width: 380px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .game-container {
            width: 100%;
            height: 400px;
            background: linear-gradient(180deg, #ffeef8 0%, #ffd0e8 100%);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            border: 3px solid #e85a8f;
        }

        .game-area {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: crosshair;
        }

        .game-ui {
            position: absolute;
            top: 15px;
            left: 15px;
            right: 15px;
            display: flex;
            justify-content: space-between;
            z-index: 20;
        }

        .game-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            color: #d64570;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            font-family: 'Quicksand', sans-serif;
        }

        .falling-heart {
            position: absolute;
            font-size: 2.2rem;
            cursor: pointer;
            user-select: none;
            animation: fall linear;
            z-index: 10;
        }

        @keyframes fall {
            from { transform: translateY(-50px) rotate(0deg); }
            to { transform: translateY(420px) rotate(360deg); }
        }

        .game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 30;
            border-radius: 17px;
        }

        .game-overlay.hidden {
            display: none;
        }

        .game-title {
            font-size: 2.5rem;
            color: #d64570;
            margin-bottom: 15px;
            font-family: 'Great Vibes', cursive;
        }

        .game-result {
            text-align: center;
            padding: 0 20px;
        }

        .game-btn {
            background: linear-gradient(135deg, #e85a8f, #d64570);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            font-family: 'Quicksand', sans-serif;
            transition: transform 0.3s;
        }

        .game-btn:hover {
            transform: scale(1.05);
        }

        .ring-wrapper {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 20px 0;
        }

        .ring-circle {
            width: 200px;
            height: 200px;
            border: 8px solid #FFD700;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 248, 220, 0.3);
        }

        .ring-text-rotating {
            position: absolute;
            width: 100%;
            height: 100%;
            animation: rotateText 8s linear infinite;
        }

        @keyframes rotateText {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .ring-diamond {
            font-size: 60px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            z-index: 10;
        }

        .ring-diamond:hover {
            transform: scale(1.2);
        }

        .secret-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #FFF8DC, #FFE4B5);
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            opacity: 0;
            transition: all 0.4s ease;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
            z-index: 5;
        }

        .secret-message.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .secret-text {
            font-size: 0.9rem;
            color: #8B4513;
            text-align: center;
            line-height: 1.3;
            font-family: 'Great Vibes', cursive;
        }

        .secret-heart {
            font-size: 1.5rem;
            margin-top: 5px;
            animation: heartbeat 1s infinite;
        }

        .click-hint {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            color: #e85a8f;
            white-space: nowrap;
            font-family: 'Quicksand', sans-serif;
            opacity: 0.8;
        }

        .promise-btn {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #8B4513;
            border: none;
            padding: 18px 50px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            font-family: 'Quicksand', sans-serif;
            transition: all 0.3s;
        }

        .promise-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
        }

        .promise-btn:disabled {
            opacity: 0.7;
            cursor: default;
        }

        .promise-text {
            color: #d64570;
            font-size: 1.4rem;
            text-align: center;
            margin-top: 20px;
            max-width: 350px;
            opacity: 0;
            transition: opacity 1s;
            font-family: 'Great Vibes', cursive;
        }

        .promise-text.show {
            opacity: 1;
        }

        .calculator-box {
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 25px;
            width: 100%;
            max-width: 360px;
            text-align: center;
        }

        .calc-inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .calc-input {
            padding: 15px;
            border: 2px solid #e85a8f;
            border-radius: 50px;
            font-size: 1.3rem;
            text-align: center;
            outline: none;
            font-family: 'Great Vibes', cursive;
            transition: all 0.3s;
        }

        .calc-input:focus {
            box-shadow: 0 0 15px rgba(232, 90, 143, 0.3);
            transform: scale(1.02);
        }

        .calc-btn {
            background: linear-gradient(135deg, #e85a8f, #d64570);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            transition: all 0.3s;
        }

        .calc-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(232, 90, 143, 0.4);
        }

        .calc-result {
            margin-top: 25px;
            display: none;
        }

        .calc-percent {
            font-size: 5rem;
            color: #e85a8f;
            font-family: 'Great Vibes', cursive;
        }

        .polaroid-container {
            width: 100%;
            max-width: 380px;
            height: 450px;
            position: relative;
            overflow: hidden;
        }

        .polaroid {
            position: absolute;
            background: white;
            padding: 10px 10px 35px 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: all 0.4s;
        }

        .polaroid:nth-child(1) { top: 5%; left: 5%; transform: rotate(-10deg); }
        .polaroid:nth-child(2) { top: 8%; right: 5%; transform: rotate(8deg); }
        .polaroid:nth-child(3) { top: 38%; left: 12%; transform: rotate(-5deg); }
        .polaroid:nth-child(4) { top: 35%; right: 8%; transform: rotate(12deg); }
        .polaroid:nth-child(5) { bottom: 10%; left: 5%; transform: rotate(7deg); }
        .polaroid:nth-child(6) { bottom: 8%; right: 10%; transform: rotate(-8deg); }

        .polaroid:hover {
            z-index: 100;
            transform: scale(1.15) rotate(0deg) !important;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .polaroid img {
            width: 110px;
            height: 110px;
            object-fit: cover;
            display: block;
        }

        .polaroid-cap {
            position: absolute;
            bottom: 8px;
            left: 0;
            right: 0;
            text-align: center;
            font-family: 'Great Vibes', cursive;
            font-size: 1rem;
            color: #555;
        }

        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 5000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox img {
            max-width: 85%;
            max-height: 65%;
            border: 15px solid white;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        .lightbox-text {
            color: white;
            font-family: 'Great Vibes', cursive;
            font-size: 2.5rem;
            margin-top: 20px;
        }

        .lightbox-close {
            position: absolute;
            top: 30px;
            right: 40px;
            color: white;
            font-size: 4rem;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .lightbox-close:hover {
            transform: rotate(90deg);
        }

        .nav-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: auto;
            padding: 20px 0 80px 0;
            flex-wrap: wrap;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(232, 90, 143, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .dot.active {
            background: #e85a8f;
            transform: scale(1.3);
        }

        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            background: #e85a8f;
            z-index: 9999;
            animation: confettiFall 3s ease-out forwards;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .restart-btn {
            margin-top: 25px;
            padding: 15px 35px;
            background: transparent;
            border: 3px solid #e85a8f;
            color: #e85a8f;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-family: 'Quicksand', sans-serif;
            font-weight: 600;
            transition: all 0.3s;
        }

        .restart-btn:hover {
            background: #e85a8f;
            color: white;
            transform: scale(1.05);
        }

        .quiz-box {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 12px;
            border: 1px solid rgba(232, 90, 143, 0.2);
        }

        .quiz-question {
            color: #d64570;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
            font-family: 'Quicksand', sans-serif;
        }

        .quiz-option {
            display: block;
            width: 100%;
            background: white;
            border: 2px solid #e85a8f;
            padding: 10px 15px;
            border-radius: 20px;
            margin: 6px 0;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
            font-family: 'Quicksand', sans-serif;
        }

        .quiz-option:hover:not(:disabled) {
            background: #ffe0f0;
            transform: translateX(5px);
        }

        .quiz-option.correct {
            background: #90EE90 !important;
            border-color: #228B22 !important;
            color: #006400 !important;
        }

        .quiz-option.wrong {
            background: #FFB6C1 !important;
            border-color: #DC143C !important;
            color: #8B0000 !important;
        }

        .quiz-option:disabled {
            cursor: default;
        }

        /* Sparkle Animation */
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        .sparkle {
            position: fixed;
            pointer-events: none;
            z-index: 9998;
            animation: sparkle 1s ease-out forwards;
        }

        /* LOVE TIMELINE - NEW FEATURE */
        .love-timeline {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 0;
            z-index: 100;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 25px rgba(232, 90, 143, 0.3);
            border: 2px solid rgba(232, 90, 143, 0.3);
        }

        .timeline-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .timeline-item:hover {
            transform: translateY(-5px);
            background: rgba(232, 90, 143, 0.1);
        }

        .timeline-heart {
            width: 20px;
            height: 20px;
            background: #e85a8f;
            transform: rotate(45deg);
            margin-bottom: 8px;
            position: relative;
            transition: all 0.3s;
        }

        .timeline-heart::before,
        .timeline-heart::after {
            content: '';
            width: 20px;
            height: 20px;
            background: #e85a8f;
            border-radius: 50%;
            position: absolute;
        }

        .timeline-heart::before {
            left: -10px;
        }

        .timeline-heart::after {
            top: -10px;
        }

        .timeline-item:hover .timeline-heart,
        .timeline-item.active .timeline-heart {
            background: #ff1493;
            box-shadow: 0 0 20px rgba(232, 90, 143, 0.8);
            transform: rotate(45deg) scale(1.2);
        }

        .timeline-item:hover .timeline-heart::before,
        .timeline-item:hover .timeline-heart::after,
        .timeline-item.active .timeline-heart::before,
        .timeline-item.active .timeline-heart::after {
            background: #ff1493;
        }

        .timeline-label {
            font-size: 0.75rem;
            color: #d64570;
            font-weight: 600;
            white-space: nowrap;
            font-family: 'Quicksand', sans-serif;
        }

        .timeline-date {
            font-size: 0.6rem;
            color: #999;
            margin-top: 2px;
        }

        .timeline-line {
            width: 40px;
            height: 2px;
            background: linear-gradient(90deg, #e85a8f, #ffb6c1);
            margin: 0 5px;
            position: relative;
            top: -10px;
        }

        .timeline-line::after {
            content: '‚ù§Ô∏è';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8px;
            background: white;
            padding: 0 3px;
        }

        /* Particle Burst Animation */
        @keyframes particleBurst {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }

        /* Toast Notification */
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar" style="width: 0%"></div>

    <!-- Parallax Background Layers -->
    <div class="parallax-layer" id="parallaxLayer1"></div>
    <div class="parallax-layer" id="parallaxLayer2"></div>
    <div class="parallax-layer" id="parallaxLayer3"></div>

    <!-- Love Quotes - Fixed -->
    <div class="love-quotes-container">
        <div class="love-quote" data-index="0">"Every love story is beautiful, but ours is my favorite"</div>
        <div class="love-quote" data-index="1">"In your smile, I see something more beautiful than stars"</div>
        <div class="love-quote" data-index="2">"You are my today and all of my tomorrows"</div>
        <div class="love-quote" data-index="3">"Together is a wonderful place to be"</div>
    </div>

    <!-- Milestone Bubbles -->
    <div class="milestone-container">
        <div class="milestone-bubble" onclick="triggerMilestone(this)">üíï First Meet</div>
        <div class="milestone-bubble" onclick="triggerMilestone(this)">üíç Proposal</div>
        <div class="milestone-bubble" onclick="triggerMilestone(this)">üè† Together</div>
        <div class="milestone-bubble" onclick="triggerMilestone(this)">‚àû Forever</div>
    </div>

    <!-- Date Badge -->
    <div class="date-badge">
        <span class="label">Together Since</span>
        <span class="value" id="dateText">Loading...</span>
    </div>

    <div class="garden-badge" onclick="openGarden()">
        <span>üåπ</span>
        <span id="roseCount">0/7</span>
    </div>

    <div class="garden-modal" id="gardenModal" onclick="closeGarden(event)">
        <div class="garden-container" onclick="event.stopPropagation()">
            <h2 style="color: #d64570; font-size: 2.5rem; margin-bottom: 10px;">Your Rose Garden üåπ</h2>
            <p style="color: #666; margin-bottom: 25px;">Click on unlocked roses!</p>
            
            <div class="rose-grid">
                <div class="rose-item" onclick="showRoseMessage(0)">üåπ</div>
                <div class="rose-item" onclick="showRoseMessage(1)">üå∏</div>
                <div class="rose-item" onclick="showRoseMessage(2)">üå∫</div>
                <div class="rose-item" onclick="showRoseMessage(3)">üå∑</div>
                <div class="rose-item" onclick="showRoseMessage(4)">üåª</div>
                <div class="rose-item" onclick="showRoseMessage(5)">üåº</div>
                <div class="rose-item" onclick="showRoseMessage(6)">üíê</div>
            </div>
            
            <div class="rose-message" id="roseMessage"></div>
            <button onclick="closeGardenDirect()" style="margin-top: 20px; padding: 12px 30px; background: #e85a8f; color: white; border: none; border-radius: 25px; cursor: pointer;">Close</button>
        </div>
    </div>

    <div class="completion-toast" id="completionToast">
        üåπ Rose <span id="roseNumber">1</span>/7 Unlocked!
    </div>

    <div class="audio-permission" id="audioPermission" onclick="initAudio()">
        üéµ Tap to enable music
    </div>

    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <div class="lightbox-close">√ó</div>
        <img id="lightboxImg" src="" alt="Memory">
        <div class="lightbox-text" id="lightboxText"></div>
    </div>

    <button class="music-play-btn" id="musicBtn" onclick="toggleMusic()">‚ñ∂Ô∏è</button>
    <button class="dark-mode-toggle" onclick="toggleDarkMode()">üåô</button>

    <div class="container">
        <div class="card-frame" id="cardFrame">
            <!-- Nav Arrows Inside Card Container -->
            <button class="nav-arrow prev" id="prevArrow" onclick="prevPage()">‚ùÆ</button>
            <button class="nav-arrow next" id="nextArrow" onclick="nextPage()">‚ùØ</button>
            
            <!-- Card 1: Question -->
            <div class="page active" id="page1">
                <div class="gift-icon">üéÅ</div>
                <h1>Will you be my<br>Valentine?</h1>
                
                <div class="love-meter" id="loveMeter">
                    <div class="meter-label">Our Love Meter</div>
                    <div class="meter-bar">
                        <div class="meter-fill" id="meterFill"></div>
                    </div>
                    <div class="meter-percentage" id="meterPercent">0%</div>
                </div>

                <div class="buttons">
                    <button class="no-btn" id="noBtn">No ü•∫</button>
                    <button class="yes-btn" onclick="sayYes()">ü§ç Yes ü§ç</button>
                </div>
            </div>

            <!-- Card 2: Success -->
            <div class="page" id="page2">
                <h2>Yay! You made my day! ‚ù§Ô∏è</h2>
                <div style="width: 280px; height: 320px; border-radius: 20px; overflow: hidden; margin: 15px auto; border: 5px solid white; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                    <img src="images/DSC_2682.JPG" style="width: 100%; height: 100%; object-fit: cover;">
                </div>
                <div style="display: flex; gap: 20px; font-size: 2.5rem; margin: 20px 0;">
                    <span style="animation: bounce 2s infinite;">üåπ</span>
                    <span style="animation: heartbeat 1.5s infinite;">üíó</span>
                    <span style="animation: bounce 2s infinite 0.5s;">üåπ</span>
                </div>
                <p style="color: #d64570; font-size: 1.8rem; font-family: 'Great Vibes', cursive;">I love you! üåπ‚ú®</p>
            </div>

            <!-- Card 3: Memories -->
            <div class="page" id="page3">
                <h2>Our Memories üíï</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 320px;">
                    <div onclick="burstHearts(event)" style="height: 140px; border-radius: 15px; overflow: hidden; border: 3px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s;">
                        <img src="images/DSC_1910.JPG" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div onclick="burstHearts(event)" style="height: 140px; border-radius: 15px; overflow: hidden; border: 3px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s;">
                        <img src="images/rect.JPG" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div onclick="burstHearts(event)" style="height: 140px; border-radius: 15px; overflow: hidden; border: 3px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s;">
                        <img src="images/green.JPG" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                    <div onclick="burstHearts(event)" style="height: 140px; border-radius: 15px; overflow: hidden; border: 3px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.3s;">
                        <img src="images/DSC_2336.JPG" style="width: 100%; height: 100%; object-fit: cover;">
                    </div>
                </div>
                <p style="color: #d64570; font-size: 1.5rem; margin-top: 20px; font-family: 'Great Vibes', cursive;">"Every moment with you is beautiful..."</p>
            </div>

            <!-- Card 4: Reasons I Love You -->
            <div class="page" id="page4">
                <h2>Reasons I Love You üíù</h2>
                <div class="reasons-container">
                    <div class="reason-box" onclick="burstHearts(event)">
                        <span class="reason-icon">üíñ</span>
                        <span class="reason-text">Your smile brightens my darkest days</span>
                    </div>
                    <div class="reason-box" onclick="burstHearts(event)">
                        <span class="reason-icon">üíñ</span>
                        <span class="reason-text">You understand me like no one else</span>
                    </div>
                    <div class="reason-box" onclick="burstHearts(event)">
                        <span class="reason-icon">üíñ</span>
                        <span class="reason-text">Your laugh is my favorite sound</span>
                    </div>
                    <div class="reason-box" onclick="burstHearts(event)">
                        <span class="reason-icon">üíñ</span>
                        <span class="reason-text">You make ordinary moments magical</span>
                    </div>
                    <div class="reason-box" onclick="burstHearts(event)">
                        <span class="reason-icon">üíñ</span>
                        <span class="reason-text">You're my best friend and soulmate</span>
                    </div>
                </div>
            </div>

            <!-- Card 5: Forever -->
            <div class="page" id="page5">
                <h2>Forever Yours üíç</h2>
                <div style="background: rgba(255,255,255,0.7); padding: 25px; border-radius: 20px; width: 100%; max-width: 360px;">
                    <p class="typewriter-text" id="typewriter"></p>
                    <p style="text-align: right; color: #e85a8f; font-size: 1.4rem; margin-top: 15px; font-family: 'Great Vibes', cursive;">Yours Eternally,<br>‚ù§Ô∏è</p>
                </div>
                <div style="font-size: 4rem; margin-top: 20px; animation: heartbeat 1.5s infinite;">üíó</div>
            </div>

            <!-- Card 6: Quiz -->
            <div class="page" id="page6">
                <h2 style="margin-bottom: 5px;">Quiz Time! ‚ùì</h2>
                <p style="color: #e85a8f; margin-bottom: 15px;">How well do you know me?</p>
                <div id="quizBox" style="width: 100%; max-width: 360px; height: 380px; overflow-y: auto; padding: 10px;">
                    <!-- Quiz inserted by JS -->
                </div>
                <div id="quizScore" style="display: none; margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.9); border-radius: 15px; color: #e85a8f; font-weight: bold;"></div>
            </div>

            <!-- Card 7: Secret Decoder -->
            <div class="page" id="page7">
                <h2 style="margin-bottom: 5px;">Secret Message üîê</h2>
                <p style="color: #e85a8f; margin-bottom: 20px;">Decode my hidden message!</p>
                <div style="background: rgba(255,255,255,0.9); padding: 25px; border-radius: 20px; width: 100%; max-width: 360px;">
                    <div id="encodedMessage" style="background: #ffe0f0; padding: 15px; border-radius: 10px; text-align: center; font-size: 1.4rem; color: #d64570; margin-bottom: 15px; word-break: break-all;">Uryyb, zl ybir!</div>
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                        <span style="color: #d64570; font-weight: 600;">Shift:</span>
                        <input type="range" id="decoderSlider" min="0" max="25" value="0" oninput="decodeMessage(this.value)" style="flex: 1;">
                        <span id="shiftValue" style="background: #e85a8f; color: white; width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">0</span>
                    </div>
                    <div id="decodedOutput" style="background: #f0fff0; padding: 15px; border-radius: 10px; min-height: 50px; display: flex; align-items: center; justify-content: center; color: #228B22; font-weight: 600;">Adjust slider...</div>
                </div>
            </div>

            <!-- Card 8: Game -->
            <div class="page" id="page8">
                <h2 style="margin-bottom: 5px;">Catch the Hearts! üéÆ</h2>
                <p style="color: #e85a8f; margin-bottom: 15px;">Catch as many as you can in 30 seconds!</p>
                
                <div class="game-wrapper">
                    <div class="game-container">
                        <div class="game-area" id="gameArea">
                            <div class="game-ui">
                                <div class="game-box">Score: <span id="gameScore">0</span></div>
                                <div class="game-box">Time: <span id="gameTimer">30</span>s</div>
                            </div>
                            
                            <!-- Start Screen -->
                            <div class="game-overlay" id="gameStart">
                                <div class="game-title">‚ù§Ô∏è Ready? ‚ù§Ô∏è</div>
                                <p style="color: #e85a8f; margin-bottom: 20px;">Catch hearts to reveal reasons!</p>
                                <button class="game-btn" onclick="startGame()">Start Game</button>
                            </div>
                            
                            <!-- Game Over Screen -->
                            <div class="game-overlay hidden" id="gameOver">
                                <div class="game-title">‚è∞ Time's Up!</div>
                                <div class="game-result">
                                    <p id="finalScore" style="font-size: 1.3rem; color: #d64570; font-weight: 600;">You caught 0 hearts!</p>
                                    <p id="gameReasons" style="color: #666; margin: 10px 0; font-style: italic; font-size: 0.95rem; max-height: 80px; overflow-y: auto;"></p>
                                </div>
                                <button class="game-btn" onclick="startGame()">Play Again üîÑ</button>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center; color: #e85a8f; font-size: 0.9rem; padding: 10px; background: rgba(255,255,255,0.6); border-radius: 10px;">
                        üí° Each heart = 1 reason why I love you!
                    </div>
                </div>
            </div>

            <!-- Card 9: Promise Ring -->
            <div class="page" id="page9">
                <h2>Promise Ring üíç</h2>
                
                <div class="ring-wrapper" onclick="toggleSecret()">
                    <div class="ring-circle">
                        <div class="ring-text-rotating" id="ringText"></div>
                        <div class="ring-diamond">üíé</div>
                        <div class="secret-message" id="secretMsg">
                            <div class="secret-text">"You're my forever and always"</div>
                            <div class="secret-heart">üíñ</div>
                        </div>
                    </div>
                    <div class="click-hint">Click diamond to reveal!</div>
                </div>
                
                <button class="promise-btn" id="promiseBtn" onclick="makePromise()">I Promise üíñ</button>
                <p class="promise-text" id="promiseText">"I promise to love you forever, through every joy and challenge, today and always."</p>
            </div>

            <!-- Card 10: Love Calculator -->
            <div class="page" id="page10">
                <h2>Love Calculator üíØ</h2>
                <p style="color: #e85a8f; margin-bottom: 15px;">Discover our compatibility!</p>
                
                <div class="calculator-box">
                    <div class="calc-inputs">
                        <input type="text" class="calc-input" id="name1" value="My Love" placeholder="Your Name">
                        <div style="font-size: 2rem;">‚ù§Ô∏è</div>
                        <input type="text" class="calc-input" id="name2" value="My Valentine" placeholder="Partner's Name">
                    </div>
                    <button class="calc-btn" onclick="calculateLove()">Calculate üíï</button>
                    
                    <div class="calc-result" id="calcResult">
                        <div class="calc-percent" id="calcPercent">0%</div>
                        <div style="width: 100%; height: 15px; background: #ffe0f0; border-radius: 10px; margin: 10px 0; overflow: hidden;">
                            <div id="calcFill" style="height: 100%; width: 0%; background: linear-gradient(90deg, #ffb6c1, #e85a8f); border-radius: 10px; transition: width 2s;"></div>
                        </div>
                        <p id="calcText" style="color: #d64570; font-size: 1.3rem; font-family: 'Great Vibes', cursive;">Soulmates! üíë</p>
                    </div>
                </div>
            </div>

            <!-- Card 11: Polaroid Wall -->
            <div class="page" id="page11">
                <h2>Our Moments üì∏</h2>
                <p style="color: #e85a8f; margin-bottom: 10px;">Click to relive memories!</p>
                
                <div class="polaroid-container">
                    <div class="polaroid" onclick="openLightbox(this, 'First Date üíï')">
                        <img src="images/DSC_4769.JPG">
                        <div class="polaroid-cap">First Date</div>
                    </div>
                    <div class="polaroid" onclick="openLightbox(this, 'Rainy Day ‚òî')">
                        <img src="images/single.JPG">
                        <div class="polaroid-cap">Rainy Day</div>
                    </div>
                    <div class="polaroid" onclick="openLightbox(this, 'Sunset üåÖ')">
                        <img src="images/DSC00555.JPG">
                        <div class="polaroid-cap">Sunset</div>
                    </div>
                    <div class="polaroid" onclick="openLightbox(this, 'Coffee ‚òï')">
                        <img src="images/DSC_3661.JPG">
                        <div class="polaroid-cap">Coffee</div>
                    </div>
                    <div class="polaroid" onclick="openLightbox(this, 'Holding Hands ü§ù')">
                        <img src="images/DSC_4654.JPG">
                        <div class="polaroid-cap">Together</div>
                    </div>
                    <div class="polaroid" onclick="openLightbox(this, 'Forever üíç')">
                        <img src="images/DSC_7329.JPG">
                        <div class="polaroid-cap">Forever</div>
                    </div>
                </div>
                
                <button class="restart-btn" onclick="restart()">üíï Experience Again</button>
            </div>

        </div>
        <div class="nav-dots" id="navDots"></div>
    </div>

    <!-- Love Timeline - NEW FEATURE -->
    <div class="love-timeline">
        <div class="timeline-item" onclick="jumpToMilestone(3, 'First Meet')">
            <div class="timeline-heart"></div>
            <span class="timeline-label">First Meet</span>
            <span class="timeline-date">3 Jul 2022</span>
        </div>
        <div class="timeline-line"></div>
        <div class="timeline-item" onclick="jumpToMilestone(9, 'Proposal')">
            <div class="timeline-heart"></div>
            <span class="timeline-label">Proposal</span>
            <span class="timeline-date">3 Dec 2022</span>
        </div>
        <div class="timeline-line"></div>
        <div class="timeline-item" onclick="jumpToMilestone(2, 'Together')">
            <div class="timeline-heart"></div>
            <span class="timeline-label">Together</span>
            <span class="timeline-date">9 Feb 2023</span>
        </div>
        <div class="timeline-line"></div>
        <div class="timeline-item" onclick="jumpToMilestone(11, 'Forever')">
            <div class="timeline-heart"></div>
            <span class="timeline-label">Forever</span>
            <span class="timeline-date">Till Last</span>
        </div>
    </div>

    <audio id="bgMusic" loop preload="auto"></audio>

    <script>
        const loveSong = 'song.mp3';
        const marriageDate = new Date('2023-02-09');
        const totalPages = 11;
        let currentPage = 1;
        let yesClicked = false;
        let isPlaying = false;
        let audioInitialized = false;

        let unlockedRoses = [false, false, false, false, false, false, false];
        const roseMessages = [
            "Our love story began with a single yes... üí´",
            "Your smile lights up my world every day... ‚òÄÔ∏è",
            "Every moment with you is a treasure... üíé",
            "You're my favorite notification... üì±",
            "My heart beats only for you... üíì",
            "Together is my favorite place... üè†",
            "Forever isn't long enough with you... ‚ôæÔ∏è"
        ];

        const quizQuestions = [
            { q: "What nickname do I call you?", options: ["Baby", "Babe", "Sweetheart", "All of these"], correct: 3 },
            { q: "What's my favorite color?", options: ["White", "Blue", "Pink", "Black"], correct: 0 },
            { q: "Which food do I love?", options: ["Pizza", "Biryani", "Chocolate", "Ice Cream"], correct: 1 },
            { q: "What's my biggest fear?", options: ["Heights", "Spiders", "Losing you", "Darkness"], correct: 2 },
            { q: "What annoys me?", options: ["Being late", "Loud noises", "Mess", "All"], correct: 3 },
            { q: "Movie genre?", options: ["Romance", "Action", "Comedy", "Horror"], correct: 0 },
            { q: "Favorite thing about you?", options: ["Smile", "Care", "Everything", "Jokes"], correct: 2 },
            { q: "What's my favorite hobby?", options: ["Reading", "Dancing", "Cooking", "Sleeping"], correct: 2 },
            { q: "Which drink do I prefer?", options: ["Coffee", "Tea", "Juice", "Water"], correct: 1 },
            { q: "Which emoji do I use most for you?", options: ["‚ù§Ô∏è", "üòò", "ü•∞", "üòç"], correct: 0 },
            { q: "What superpower would I choose?", options: ["Invisibility", "Flying", "Reading minds", "Time travel"], correct: 2 },
            { q: "What do I do at 3 AM?", options: ["Sleep", "Text you", "Overthink", "Eat"], correct: 1 },
            { q: "Which pet do I prefer?", options: ["Dog", "Cat", "Rabbit", "Fish"], correct: 2 },
            { q: "What's my favorite season?", options: ["Spring", "Summer", "Autumn", "Winter"], correct: 3 }
        ];

        let quizScore = 0;
        let quizAnswered = 0;
        let answeredQ = new Array(14).fill(false);

        const secretMsg = "Hello, my love! I love you forever! ‚ù§Ô∏è";
        const encoded = caesarCipher(secretMsg, 13);

        let gameScore = 0;
        let gameTime = 30;
        let gameTimer, spawnTimer;
        let isGameActive = false;

        const reasonsList = [
            "Your beautiful smile üòä", "Your caring nature ü§ó", "Your amazing laugh üòÑ",
            "Your intelligence üß†", "Your kindness ‚ù§Ô∏è", "Your strength üí™",
            "Your honesty üåü", "Your humor üòÇ", "Your patience üïäÔ∏è",
            "Your love for me üíï", "Your support ü§ù", "Your beautiful eyes üëÄ",
            "Your sweet voice üéµ", "Your warm hugs ü§ó", "Your gentle kisses üòò",
            "Your warmth ‚òÄÔ∏è", "Your gentleness üå∏", "Your passion üî•",
            "Your dreams üåô", "Your pure heart üíó", "Your presence ‚ú®",
            "Your loving touch ü§≤", "Your deep thoughts üí≠", "Your beautiful soul üëª",
            "Your everything üåπ"
        ];

        window.onload = function() {
            setTimeout(() => {
                document.getElementById('audioPermission').classList.add('show');
            }, 500);
            
            initDate();
            setInterval(initDate, 60000);
            createParallaxHearts();
            createFloating();
            buildDots();
            setupNoBtn();
            buildQuiz();
            initRing();
            document.getElementById('encodedMessage').textContent = encoded;
            setupCardTilt();
            startQuoteRotation();
        };

        function startQuoteRotation() {
            let currentQuote = 0;
            const quotes = document.querySelectorAll('.love-quote');
            
            function rotateQuotes() {
                quotes.forEach((q, i) => {
                    q.classList.toggle('active', i === currentQuote);
                });
                currentQuote = (currentQuote + 1) % quotes.length;
            }
            
            rotateQuotes();
            setInterval(rotateQuotes, 4000);
        }

        function createParallaxHearts() {
            const layers = [
                { id: 'parallaxLayer1', count: 15, speed: 15, size: 15 },
                { id: 'parallaxLayer2', count: 10, speed: 10, size: 25 },
                { id: 'parallaxLayer3', count: 5, speed: 20, size: 35 }
            ];

            layers.forEach(layer => {
                const container = document.getElementById(layer.id);
                for (let i = 0; i < layer.count; i++) {
                    const heart = document.createElement('div');
                    heart.className = 'parallax-heart';
                    heart.textContent = ['‚ù§Ô∏è', 'üíñ', 'üíó', 'üíï', 'üíù'][Math.floor(Math.random() * 5)];
                    heart.style.left = Math.random() * 100 + '%';
                    heart.style.fontSize = layer.size + 'px';
                    heart.style.animationDuration = (Math.random() * layer.speed + layer.speed) + 's';
                    heart.style.animationDelay = Math.random() * 5 + 's';
                    container.appendChild(heart);
                }
            });
        }

        function setupCardTilt() {
            const card = document.getElementById('cardFrame');
            
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                const rotateX = (y - centerY) / 30;
                const rotateY = (centerX - x) / 30;
                
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                
                card.style.setProperty('--mouse-x', (x / rect.width * 100) + '%');
                card.style.setProperty('--mouse-y', (y / rect.height * 100) + '%');
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
            });
        }

        function triggerMilestone(el) {
            el.style.transform = 'scale(1.3)';
            el.style.background = 'linear-gradient(135deg, #e85a8f, #d64570)';
            el.style.color = 'white';
            
            setTimeout(() => {
                el.style.transform = 'scale(1.1)';
                el.style.background = '';
                el.style.color = '';
            }, 300);
            
            const rect = el.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const p = document.createElement('div');
                    p.textContent = ['‚ù§Ô∏è', 'üíñ', '‚ú®', 'üéâ', 'üíï'][Math.floor(Math.random() * 5)];
                    p.style.cssText = `
                        position: fixed;
                        left: ${centerX}px;
                        top: ${centerY}px;
                        font-size: ${Math.random() * 15 + 15}px;
                        pointer-events: none;
                        z-index: 9999;
                        animation: particleBurst 1s ease-out forwards;
                    `;
                    const angle = (Math.PI * 2 * i) / 30;
                    const velocity = 50 + Math.random() * 100;
                    p.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
                    p.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');
                    document.body.appendChild(p);
                    setTimeout(() => p.remove(), 1000);
                }, i * 20);
            }
        }

        function jumpToMilestone(pageNum, label) {
            const hearts = document.querySelectorAll('.timeline-heart');
            const clickedHeart = event.currentTarget.querySelector('.timeline-heart');
            const rect = clickedHeart.getBoundingClientRect();
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const p = document.createElement('div');
                    p.textContent = ['‚ù§Ô∏è', 'üíñ', '‚ú®'][Math.floor(Math.random() * 3)];
                    p.style.cssText = `
                        position: fixed;
                        left: ${rect.left + 10}px;
                        top: ${rect.top + 10}px;
                        font-size: ${Math.random() * 10 + 15}px;
                        pointer-events: none;
                        z-index: 9999;
                        animation: particleBurst 0.8s ease-out forwards;
                    `;
                    const angle = (Math.PI * 2 * i) / 20;
                    const velocity = 30 + Math.random() * 50;
                    p.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
                    p.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');
                    document.body.appendChild(p);
                    setTimeout(() => p.remove(), 800);
                }, i * 15);
            }
            
            setTimeout(() => {
                if (yesClicked || pageNum === 1) {
                    goToPage(pageNum);
                } else if (pageNum !== 1) {
                    showToast('üíï Say Yes first! üíï');
                }
            }, 300);
        }

        function updateTimelineActive() {
            const pageToMilestone = {3: 0, 9: 1, 2: 2, 11: 3};
            const milestoneIndex = pageToMilestone[currentPage];
            
            document.querySelectorAll('.timeline-item').forEach((item, idx) => {
                item.classList.toggle('active', idx === milestoneIndex);
            });
        }

        function showToast(msg) {
            const toast = document.createElement('div');
            toast.textContent = msg;
            toast.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #e85a8f, #d64570);
                color: white;
                padding: 20px 40px;
                border-radius: 50px;
                font-size: 1.2rem;
                font-weight: 600;
                z-index: 10000;
                animation: fadeInOut 2s ease;
            `;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 2000);
        }

        function initAudio() {
            audioInitialized = true;
            document.getElementById('audioPermission').classList.remove('show');
            const audio = document.getElementById('bgMusic');
            audio.src = loveSong;
            audio.volume = 0.6;
            audio.play().then(() => {
                isPlaying = true;
                document.getElementById('musicBtn').textContent = '‚è∏Ô∏è';
                document.getElementById('musicBtn').classList.add('playing');
            }).catch(e => alert("Please add your song file as 'kahani_suno_2.0.mp3' in the same folder!"));
        }

        function initDate() {
            const now = new Date();
            const diff = now - marriageDate;
            const y = Math.floor(diff / (365.25 * 24 * 60 * 60 * 1000));
            const m = Math.floor((diff % (365.25 * 24 * 60 * 60 * 1000)) / (30.44 * 24 * 60 * 60 * 1000));
            const d = Math.floor((diff % (30.44 * 24 * 60 * 60 * 1000)) / (24 * 60 * 60 * 1000));
            document.getElementById('dateText').textContent = `${y} Years ${m} Months ${d} Days`;
        }

        function unlockRose(cardIdx) {
            const map = {1:0, 2:1, 3:2, 4:3, 5:4, 6:5, 8:6};
            const roseIdx = map[cardIdx];
            if (roseIdx !== undefined && !unlockedRoses[roseIdx]) {
                unlockedRoses[roseIdx] = true;
                updateRoseBadge();
                document.getElementById('roseNumber').textContent = roseIdx + 1;
                document.getElementById('completionToast').classList.add('show');
                setTimeout(() => document.getElementById('completionToast').classList.remove('show'), 3000);
                createConfetti();
            }
        }

        function updateRoseBadge() {
            const cnt = unlockedRoses.filter(r => r).length;
            document.getElementById('roseCount').textContent = `${cnt}/7`;
            document.querySelectorAll('.rose-item').forEach((r, i) => {
                r.classList.toggle('unlocked', unlockedRoses[i]);
            });
        }

        function openGarden() {
            document.getElementById('gardenModal').classList.add('active');
        }

        function closeGarden(e) {
            if (e.target.id === 'gardenModal') document.getElementById('gardenModal').classList.remove('active');
        }

        function closeGardenDirect() {
            document.getElementById('gardenModal').classList.remove('active');
        }

        function showRoseMessage(idx) {
            const msg = document.getElementById('roseMessage');
            msg.textContent = unlockedRoses[idx] ? roseMessages[idx] : `üîí Complete journey to unlock!`;
            msg.classList.add('show');
        }

        function createFloating() {
            const hearts = ['‚ù§Ô∏è', 'üíñ', 'üíó', 'üíï', 'üíù'];
            setInterval(() => {
                const el = document.createElement('div');
                el.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                el.style.cssText = `position:fixed;left:${Math.random()*100}vw;top:-30px;font-size:${Math.random()*15+20}px;opacity:0.6;pointer-events:none;z-index:1;animation:fall ${Math.random()*5+5}s linear forwards`;
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 10000);
            }, 1500);
        }

        document.addEventListener('mousemove', (e) => {
            if (Math.random() > 0.92) {
                const t = document.createElement('div');
                t.className = 'cursor-trail';
                t.textContent = ['üíï', 'üíñ', 'üíó', '‚ú®', 'üå∏'][Math.floor(Math.random() * 5)];
                t.style.left = e.clientX + 'px';
                t.style.top = e.clientY + 'px';
                document.body.appendChild(t);
                setTimeout(() => t.remove(), 1000);
            }
            
            if (Math.random() > 0.95) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.textContent = '‚ú®';
                sparkle.style.left = e.clientX + Math.random() * 20 - 10 + 'px';
                sparkle.style.top = e.clientY + Math.random() * 20 - 10 + 'px';
                sparkle.style.fontSize = Math.random() * 10 + 10 + 'px';
                document.body.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 1000);
            }
        });

        function caesarCipher(str, shift) {
            return str.replace(/[a-zA-Z]/g, c => {
                const b = c <= 'Z' ? 65 : 97;
                return String.fromCharCode((c.charCodeAt(0) - b + shift) % 26 + b);
            });
        }

        function decodeMessage(shift) {
            document.getElementById('shiftValue').textContent = shift;
            const dec = caesarCipher(encoded, parseInt(shift));
            const out = document.getElementById('decodedOutput');
            out.textContent = dec;
            if (dec === secretMsg) {
                out.style.background = '#90EE90';
                out.innerHTML = dec + '<br><small style="font-family:Great Vibes;font-size:1.2rem;">üéâ You decoded my heart!</small>';
                createConfetti();
            }
        }

        function startGame() {
            if (isGameActive) return;
            isGameActive = true;
            gameScore = 0;
            gameTime = 30;
            document.getElementById('gameScore').textContent = '0';
            document.getElementById('gameTimer').textContent = '30';
            document.getElementById('gameStart').classList.add('hidden');
            document.getElementById('gameOver').classList.add('hidden');
            document.querySelectorAll('.falling-heart').forEach(h => h.remove());
            
            gameTimer = setInterval(() => {
                gameTime--;
                document.getElementById('gameTimer').textContent = gameTime;
                if (gameTime <= 0) endGame();
            }, 1000);
            
            spawnTimer = setInterval(spawnHeart, 600);
        }

        function spawnHeart() {
            if (!isGameActive) return;
            const h = document.createElement('div');
            h.className = 'falling-heart';
            h.textContent = ['‚ù§Ô∏è', 'üíñ', 'üíó', 'üíï', 'üíù'][Math.floor(Math.random() * 5)];
            h.style.left = Math.random() * 85 + 5 + '%';
            h.style.animationDuration = (Math.random() * 2 + 2) + 's';
            h.onclick = function() { catchHeart(this); };
            document.getElementById('gameArea').appendChild(h);
            setTimeout(() => h.remove(), 4000);
        }

        function catchHeart(h) {
            gameScore++;
            document.getElementById('gameScore').textContent = gameScore;
            h.remove();
        }

        function endGame() {
            isGameActive = false;
            clearInterval(gameTimer);
            clearInterval(spawnTimer);
            document.querySelectorAll('.falling-heart').forEach(h => h.remove());
            
            let msg = "";
            if (gameScore === 0) msg = "Even zero can't measure my infinite love! ‚ù§Ô∏è";
            else if (gameScore <= 3) {
                const r = reasonsList.sort(() => Math.random() - 0.5).slice(0, gameScore);
                msg = r.join(' ‚Ä¢ ');
            } else {
                const r = reasonsList.sort(() => Math.random() - 0.5).slice(0, 4);
                msg = r.join('<br>') + `<br><small>...and ${gameScore - 4} more reasons! üíù</small>`;
            }
            
            document.getElementById('finalScore').textContent = `You caught ${gameScore} hearts! üíï`;
            document.getElementById('gameReasons').innerHTML = msg;
            document.getElementById('gameOver').classList.remove('hidden');
            
            if (gameScore >= 5) createConfetti();
        }

        function calculateLove() {
            const res = document.getElementById('calcResult');
            res.style.display = 'block';
            let curr = 0;
            const target = 98 + Math.floor(Math.random() * 3);
            
            const int = setInterval(() => {
                curr += 2;
                if (curr >= target) {
                    curr = target;
                    clearInterval(int);
                    document.getElementById('calcText').textContent = target === 100 ? "Perfect Match! üíë‚ú®" : "Soulmates! üíû";
                    createConfetti();
                }
                document.getElementById('calcPercent').textContent = curr + "%";
                document.getElementById('calcFill').style.width = curr + "%";
            }, 40);
        }

        function initRing() {
            const rt = document.getElementById('ringText');
            const txt = "Forever Yours ‚Ä¢ Love Eternal ‚Ä¢ ";
            for (let i = 0; i < txt.length; i++) {
                const s = document.createElement('span');
                s.textContent = txt[i];
                s.style.cssText = `position:absolute;left:50%;transform:rotate(${(i/txt.length)*360}deg);transform-origin:0 100px;font-size:12px;font-weight:bold;color:#8B4513;`;
                rt.appendChild(s);
            }
        }

        function toggleSecret() {
            const sm = document.getElementById('secretMsg');
            sm.classList.toggle('show');
            if (sm.classList.contains('show')) createConfetti();
        }

        function openLightbox(el, cap) {
            document.getElementById('lightboxImg').src = el.querySelector('img').src;
            document.getElementById('lightboxText').textContent = cap;
            document.getElementById('lightbox').classList.add('active');
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
        }

        function buildQuiz() {
            const box = document.getElementById('quizBox');
            box.innerHTML = '';
            quizScore = 0;
            quizAnswered = 0;
            answeredQ.fill(false);
            
            quizQuestions.forEach((q, i) => {
                const d = document.createElement('div');
                d.className = 'quiz-box';
                d.innerHTML = `<div class="quiz-question">Q${i+1}. ${q.q}</div>`;
                q.options.forEach((opt, j) => {
                    const b = document.createElement('button');
                    b.className = 'quiz-option';
                    b.textContent = opt;
                    b.onclick = () => answerQuiz(i, j, b);
                    d.appendChild(b);
                });
                box.appendChild(d);
            });
        }

        function answerQuiz(qIdx, selIdx, btn) {
            if (answeredQ[qIdx]) return;
            answeredQ[qIdx] = true;
            quizAnswered++;
            
            const correct = quizQuestions[qIdx].correct;
            if (selIdx === correct) quizScore++;
            
            const all = btn.parentElement.querySelectorAll('.quiz-option');
            all.forEach((b, i) => {
                b.disabled = true;
                if (i === correct) b.classList.add('correct');
                else if (i === selIdx) b.classList.add('wrong');
            });
            
            if (quizAnswered === 14) showQuizResult();
        }

        function showQuizResult() {
            const pct = Math.round((quizScore / 14) * 100);
            const msg = pct === 100 ? 'Perfect! üíØ' : pct >= 70 ? 'Great! üåü' : pct >= 50 ? 'Good! üíï' : 'We should talk more! üòÑ';
            document.getElementById('quizScore').innerHTML = `<div style="font-size:1.5rem;margin-bottom:10px;">${quizScore}/14</div><div>${pct}% - ${msg}</div>`;
            document.getElementById('quizScore').style.display = 'block';
            if (pct >= 70) createConfetti();
        }

        function setupNoBtn() {
            const btn = document.getElementById('noBtn');
            const box = document.querySelector('.buttons');
            
            const move = (e) => {
                const r = box.getBoundingClientRect();
                const mx = r.width - btn.offsetWidth;
                const my = r.height - btn.offsetHeight;
                const cx = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;
                const cy = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;
                
                let nx, ny, at = 0;
                do {
                    nx = Math.random() * mx;
                    ny = Math.random() * my;
                } while (++at < 50 && Math.abs(nx + btn.offsetWidth/2 - cx) < 100);
                
                btn.style.left = nx + 'px';
                btn.style.top = ny + 'px';
                btn.style.transform = 'none';
            };
            
            btn.addEventListener('mouseenter', move);
            btn.addEventListener('touchstart', (e) => { e.preventDefault(); move(e); });
            btn.addEventListener('click', (e) => { e.preventDefault(); move(e); });
        }

        function sayYes() {
            yesClicked = true;
            document.getElementById('loveMeter').classList.add('visible');
            document.getElementById('meterFill').classList.add('full');
            
            let p = 0;
            const t = setInterval(() => {
                p += 2;
                document.getElementById('meterPercent').textContent = p + '%';
                if (p >= 100) {
                    clearInterval(t);
                    setTimeout(() => goToPage(2), 500);
                }
            }, 40);
            
            createConfetti();
        }

        function typewriter() {
            const txt = "My Love,\n\nFrom the moment I met you, I knew my life would never be the same. You bring color to my world and warmth to my heart.\n\nI promise to stand by you through every chapter of our story, to cherish every laugh, and to hold you through every storm.\n\nYou are my today, my tomorrow, and my forever.";
            const el = document.getElementById('typewriter');
            el.textContent = '';
            
            let i = 0;
            const type = () => {
                if (i < txt.length) {
                    el.textContent += txt.charAt(i);
                    i++;
                    setTimeout(type, 30);
                }
            };
            setTimeout(type, 100);
        }

        function buildDots() {
            const c = document.getElementById('navDots');
            for (let i = 1; i <= totalPages; i++) {
                const d = document.createElement('span');
                d.className = 'dot' + (i === 1 ? ' active' : '');
                d.onclick = () => goToPage(i);
                c.appendChild(d);
            }
        }

        function goToPage(n) {
            if (n > 1 && !yesClicked && currentPage === 1) {
                showToast('üíï Please say Yes first! üíï');
                return;
            }
            if (n < 1 || n > totalPages) return;
            
            const currentEl = document.getElementById('page' + currentPage);
            const nextEl = document.getElementById('page' + n);
            
            if (n > currentPage) {
                currentEl.classList.add('exit-left');
            } else {
                currentEl.classList.add('exit-right');
            }
            
            setTimeout(() => {
                document.querySelectorAll('.page').forEach(p => {
                    p.classList.remove('active', 'exit-left', 'exit-right');
                });
                nextEl.classList.add('active');
                
                document.querySelectorAll('.dot').forEach((d, i) => d.classList.toggle('active', i === n - 1));
                
                currentPage = n;
                document.getElementById('progressBar').style.width = (n / totalPages * 100) + '%';
                document.getElementById('prevArrow').classList.toggle('visible', n > 1);
                document.getElementById('nextArrow').classList.toggle('visible', n < totalPages && (n !== 1 || yesClicked));
                
                if (n === 5) typewriter();
                unlockRose(n);
                updateTimelineActive();
            }, 300);
        }

        function nextPage() {
            if (currentPage < totalPages) goToPage(currentPage + 1);
        }

        function prevPage() {
            if (currentPage > 1) goToPage(currentPage - 1);
        }

        function makePromise() {
            document.getElementById('promiseBtn').disabled = true;
            document.getElementById('promiseBtn').textContent = 'Promise Made! üíç';
            document.getElementById('promiseText').classList.add('show');
            createConfetti();
            createFireworks();
        }

        function createConfetti() {
            const colors = ['#e85a8f', '#ffd700', '#ff69b4', '#00ff00', '#00bfff'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const c = document.createElement('div');
                    c.className = 'confetti';
                    c.style.cssText = `left:${Math.random()*100}vw;background:${colors[Math.floor(Math.random()*colors.length)]}`;
                    document.body.appendChild(c);
                    setTimeout(() => c.remove(), 3000);
                }, i * 30);
            }
        }

        function createFireworks() {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight / 2;
                    for (let j = 0; j < 20; j++) {
                        const p = document.createElement('div');
                        p.style.cssText = `position:absolute;left:${x}px;top:${y}px;width:6px;height:6px;border-radius:50%;background:${['#FFD700','#FF69B4','#00CED1'][Math.floor(Math.random()*3)]};z-index:9998;animation:particleBurst 1s ease-out forwards`;
                        const a = (Math.PI * 2 * j) / 20;
                        const v = 100 + Math.random() * 50;
                        p.style.setProperty('--tx', Math.cos(a) * v + 'px');
                        p.style.setProperty('--ty', Math.sin(a) * v + 'px');
                        document.body.appendChild(p);
                        setTimeout(() => p.remove(), 1000);
                    }
                }, i * 200);
            }
        }

        function burstHearts(e) {
            const x = e.clientX;
            const y = e.clientY;
            for (let i = 0; i < 15; i++) {
                const p = document.createElement('div');
                p.textContent = ['‚ù§Ô∏è', 'üíñ', '‚ú®'][Math.floor(Math.random() * 3)];
                p.style.cssText = `position:fixed;left:${x}px;top:${y}px;font-size:${Math.random()*20+15}px;pointer-events:none;z-index:9998;animation:particleBurst 1s ease-out forwards`;
                const a = (Math.PI * 2 * i) / 15;
                const v = 80 + Math.random() * 80;
                p.style.setProperty('--tx', Math.cos(a) * v + 'px');
                p.style.setProperty('--ty', Math.sin(a) * v + 'px');
                document.body.appendChild(p);
                setTimeout(() => p.remove(), 1000);
            }
        }

        function toggleMusic() {
            if (!audioInitialized) {
                alert("Tap 'üéµ Tap to enable music' button first!");
                return;
            }
            const a = document.getElementById('bgMusic');
            const b = document.getElementById('musicBtn');
            
            if (!isPlaying) {
                a.play().then(() => {
                    isPlaying = true;
                    b.textContent = '‚è∏Ô∏è';
                    b.classList.add('playing');
                });
            } else {
                a.pause();
                isPlaying = false;
                b.textContent = '‚ñ∂Ô∏è';
                b.classList.remove('playing');
            }
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            event.target.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è' : 'üåô';
        }

        function restart() {
            yesClicked = false;
            currentPage = 1;
            unlockedRoses.fill(false);
            updateRoseBadge();
            goToPage(1);
            
            document.getElementById('loveMeter').classList.remove('visible');
            document.getElementById('meterFill').classList.remove('full');
            document.getElementById('meterPercent').textContent = '0%';
            
            const nb = document.getElementById('noBtn');
            nb.style.left = '50%';
            nb.style.top = '0';
            nb.style.transform = 'translateX(-50%)';
            
            document.getElementById('promiseBtn').disabled = false;
            document.getElementById('promiseBtn').textContent = 'I Promise üíñ';
            document.getElementById('promiseText').classList.remove('show');
            document.getElementById('secretMsg').classList.remove('show');
            
            document.getElementById('decodedOutput').textContent = 'Adjust slider...';
            document.getElementById('decodedOutput').style.background = '#f0fff0';
            document.getElementById('decoderSlider').value = 0;
            document.getElementById('shiftValue').textContent = '0';
            
            document.getElementById('calcResult').style.display = 'none';
            document.getElementById('calcPercent').textContent = '0%';
            document.getElementById('calcFill').style.width = '0%';
            
            clearInterval(gameTimer);
            clearInterval(spawnTimer);
            isGameActive = false;
            document.getElementById('gameStart').classList.remove('hidden');
            document.getElementById('gameOver').classList.add('hidden');
            document.querySelectorAll('.falling-heart').forEach(h => h.remove());
            
            buildQuiz();
            
            if (isPlaying) {
                isPlaying = false;
                document.getElementById('musicBtn').textContent = '‚ñ∂Ô∏è';
                document.getElementById('musicBtn').classList.remove('playing');
                document.getElementById('bgMusic').pause();
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextPage();
            if (e.key === 'ArrowLeft') prevPage();
        });
    </script>
</body>

</html>

